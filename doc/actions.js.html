<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: actions.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: actions.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

module.exports = {
    clearInput,
    closeNewlyOpenedTab,
    dragAndDrop,
    executeInAlertAndDismiss,
    executeInAngular,
    executeInIframe,
    executeInProtractor,
    mouseMoveTo,
    performClicks,
    performScrolls,
    pressGlobalKey,
    selectOption,
    setWindowSize,
};

/**
 * Set browser's window size
 * @param {number} width - The desired width for the browser
 * @param {number} height - The desired height for the browser
 */
function setWindowSize(width, height) {
    browser
        .driver
        .manage()
        .window()
        .setSize(width, height);
}

/**
 * Execute a script in the context of a chosen iframe.
 * @param {string} iframeName - The name of the iframe (id)
 * @param {Function} fn
 */
function executeInIframe(iframeName, fn) {
    browser.switchTo().frame(iframeName);
    fn();
    browser.switchTo().defaultContent();
    browser.waitForAngular();
}

function executeInAlertAndDismiss(fn) {
    browser.wait(() => browser.switchTo().alert().then(() => true, () => false));
    browser.switchTo().alert().then(alert => {
        fn(alert);
        alert.dismiss();
    });
}

/**
 * Execute a function in Angular context. This allows the access to Angular's registered services.
 * @param {string} serviceName - Name of the service to retrieve
 * @param {Function} fn - The function to execute
 * @example
 * &lt;caption>Destroy Angular cache&lt;/caption>
 * toolbox.actions.executeInAngular('$cacheFactory', function ($cacheFactory) {
 *     $cacheFactory.destroy();
 * });
 */
function executeInAngular(serviceName, fn) {
    browser.executeScript((serviceName, fn) => { // eslint-disable-line no-shadow
        const service = angular.element('[ng-app]').injector().get(serviceName);
        let func;

        // See the doc: functions in arguments are resolved in their string representation
        eval(`var func = ${ fn }`); // eslint-disable-line no-eval
        func(service);

        angular.element('[ng-app]').injector().get('$rootScope').$apply();
    }, serviceName, fn);
}

/**
 * Close a newly opened tab.
 */
function closeNewlyOpenedTab() {
    browser.sleep(500); // wait for tab to be created
    browser.getAllWindowHandles().then(handles => {
        browser.switchTo().window(handles[1]); // switch driver execution to the new tab
        browser.close();
        browser.switchTo().window(handles[0]); // switch driver execution to the origin tab
    });
}

/**
 * Select a particular option of a select by its value.
 * @param {Element} select - A Protractor-wrapped element
 * @param {*} value - The value you want to select
 * @returns {Element} - The option wrapped by Protractor
 */
function selectOption(select, value) {
    return select.element(by.cssContainingText('option', value)).click();
}

/**
 * Perform a drag and drop by providing two Protractor elements
 * @param {Element} from - The Protractor-wrapped element to be moved
 * @param {Element} to - The Protractor-wrapped element receiving `from`
 */
function dragAndDrop(from, to) {
    browser
        .actions()
        .mouseDown(from)
        .mouseMove(to)
        .mouseUp()
        .perform();
}

/**
 * Move the mouse to the specified target. The target must be a selector, not a Protractor element.
 * @param {Element} target - An element where we want to move the cursor over
 *                          (not a selector, directly the element)
 */
function mouseMoveTo(target) {
    browser
        .actions()
        .mouseMove(target)
        .perform();
}

/**
 * Performs a provided number of clicks on an element.
 * @param {Element} selector - A selector used to find the element (not a Protractor element)
 * @param {number} nbClicks - The number of clicks
 */
function performClicks(selector, nbClicks) {
    browser.executeScript((selector, nbClicks) => { // eslint-disable-line no-shadow
        let i = 0;
        while (i &lt; nbClicks) {
            $(selector).click();
            i++;
        }
    }, selector, nbClicks);
}

/**
 * Performs a provided number of scrolls on the page.
 * @param {number} nbScrolls - The number of scrolls to perform
 * @param {number} pxToScroll - The number of pixel to scroll
 */
function performScrolls(nbScrolls, pxToScroll) {
    nbScrolls.forEach(() => {
        if (!pxToScroll) {
            browser.executeScript('$("html, body").scrollTop(Math.random() * 10000)');
        } else {
            browser.executeScript(`$("html, body").scrollTop(${ nbScrolls % 2 === 0 ? 0 : pxToScroll })`); // eslint-disable-line max-len
        }
    });
}

/**
 * Circumvent Protractor/Selenium's bug when clearing an input doesn't update the model.
 * @param {Element} input - The Protractor-wrapped input to clear.
 */
function clearInput(input) {
    input.clear().then(() => {
        input.sendKeys(' ');
        input.sendKeys(protractor.Key.BACK_SPACE);
    });
}

/**
 * Press a key without focusing an input/textarea
 * @param {number} key - Keycode of the key you want to press.
 */
function pressGlobalKey(key) {
    protractor
        .getInstance()
        .actions()
        .sendKeys(key)
        .perform();
}

/**
 * Execute a command in the WebDriver control flow.
 * The command must call `fulfill` or `reject` to allow protractor to continue test execution.
 * It is useful when you have external modules based in promises:
 * Protractor will wait the fulfilling/rejecting of the promise before continuing test execution.
 * @param {function} command - The function to execute. It must call either fulfill or reject.
 * @return {Promise.&lt;*>}
 */
function executeInProtractor(command) {
    return protractor.promise.controlFlow().execute(() => {
        let defer = protractor.promise.defer();
        command(defer.fulfill, defer.reject);
        return defer.promise;
    });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#$$csstext">$$csstext</a></li><li><a href="global.html#$$model">$$model</a></li><li><a href="global.html#$csstext">$csstext</a></li><li><a href="global.html#$lt">$lt</a></li><li><a href="global.html#$model">$model</a></li><li><a href="global.html#$options">$options</a></li><li><a href="global.html#clearInput">clearInput</a></li><li><a href="global.html#clearLocalStorage">clearLocalStorage</a></li><li><a href="global.html#clickAndWait">clickAndWait</a></li><li><a href="global.html#closeNewlyOpenedTab">closeNewlyOpenedTab</a></li><li><a href="global.html#deleteAllCookies">deleteAllCookies</a></li><li><a href="global.html#dragAndDrop">dragAndDrop</a></li><li><a href="global.html#executeInAngular">executeInAngular</a></li><li><a href="global.html#executeInIframe">executeInIframe</a></li><li><a href="global.html#executeInProtractor">executeInProtractor</a></li><li><a href="global.html#getAndWait">getAndWait</a></li><li><a href="global.html#getFocusedElement">getFocusedElement</a></li><li><a href="global.html#getLocalStorageValue">getLocalStorageValue</a></li><li><a href="global.html#getSelectedOption">getSelectedOption</a></li><li><a href="global.html#hasClass">hasClass</a></li><li><a href="global.html#hasOption">hasOption</a></li><li><a href="global.html#mouseMoveTo">mouseMoveTo</a></li><li><a href="global.html#performClicks">performClicks</a></li><li><a href="global.html#performScrolls">performScrolls</a></li><li><a href="global.html#pressGlobalKey">pressGlobalKey</a></li><li><a href="global.html#selectOption">selectOption</a></li><li><a href="global.html#setWindowSize">setWindowSize</a></li><li><a href="global.html#waitElement">waitElement</a></li><li><a href="global.html#waitToBeClickable">waitToBeClickable</a></li><li><a href="global.html#waitToBeDisplayed">waitToBeDisplayed</a></li><li><a href="global.html#waitToBeHidden">waitToBeHidden</a></li><li><a href="global.html#waitToDisappear">waitToDisappear</a></li><li><a href="global.html#waitToHaveClass">waitToHaveClass</a></li><li><a href="global.html#waitToHaveText">waitToHaveText</a></li><li><a href="global.html#waitToResolve">waitToResolve</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Aug 17 2016 16:52:42 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
